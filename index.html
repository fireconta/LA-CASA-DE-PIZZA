<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Casa de Pizza's</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        header {
            background-color: #f3f4f6;
            padding: 2rem 1rem;
            text-align: center;
            position: relative;
        }
        .logo {
            width: 120px;
            height: 120px;
            background-color: white;
            border-radius: 50%;
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }
        .logo:hover {
            transform: scale(1.05);
        }
        .logo img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: contain;
        }
        .status {
            background-color: #10b981;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: inline-block;
        }
        header h1 {
            font-size: 2rem;
            font-weight: 700;
            color: #dc2626;
            margin-bottom: 0.5rem;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        header p {
            font-size: 0.875rem;
            color: #4b5563;
        }
        #location-display {
            font-weight: 500;
            color: #1f2937;
            margin-top: 0.5rem;
        }
        .category-bar {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            padding: 0.5rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        .category-bar button {
            background: white;
            color: #dc2626;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, background 0.2s;
        }
        .category-bar button:hover {
            transform: scale(1.05);
            background: #f3f4f6;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f3f4f6;
        }
        .menu-section {
            background-color: white;
            padding: 1.5rem;
            margin: 1rem;
            border-radius: 0.75rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .menu-section#combos .menu-item {
            background: linear-gradient(135deg, #fee2e2, #ffffff);
            border: 4px solid #dc2626;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
            animation: pulseCombo 1.5s infinite;
        }
        @keyframes pulseCombo {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .menu-section#combos h2 {
            font-size: 1.75rem;
            color: #dc2626;
        }
        .menu-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #dc2626;
            margin-bottom: 1.25rem;
            text-transform: uppercase;
        }
        .menu-item {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            padding: 1.25rem;
            border: 2px solid #34d399;
            border-radius: 0.75rem;
            margin-bottom: 1.25rem;
        }
        .menu-img {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .discount-tag {
            background: linear-gradient(135deg, #ff0000, #b91c1c);
            color: white;
            padding: 0.3rem 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: inline-block;
        }
        .price-old {
            text-decoration: line-through;
            color: #6b7280;
            margin-right: 0.5rem;
        }
        .price-new {
            color: #dc2626;
            font-weight: 700;
            font-size: 1.125rem;
        }
        .availability {
            color: #dc2626;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .stock-info {
            font-size: 0.75rem;
            color: #4b5563;
            margin-top: 0.25rem;
        }
        .add-to-cart {
            background: linear-gradient(135deg, #16a34a, #15803d);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: none;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            transition: transform 0.2s, background 0.2s;
        }
        .add-to-cart:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, #15803d, #16a34a);
        }
        .add-to-cart.loading {
            background: #6b7280;
            cursor: wait;
        }
        .add-to-cart.loading::after {
            content: '';
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 2px solid #fff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-left: 8px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        #cart-toggle-btn {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transition: transform 0.2s, background 0.2s;
        }
        #cart-toggle-btn:hover {
            transform: scale(1.1);
            background: linear-gradient(135deg, #b91c1c, #dc2626);
        }
        #cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #16a34a;
            color: white;
            border-radius: 50%;
            padding: 0.3rem 0.6rem;
            font-size: 0.75rem;
            font-weight: bold;
        }
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: linear-gradient(135deg, #16a34a, #15803d);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            z-index: 3000;
            opacity: 0;
            transform: translateY(-10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .notification.error {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
        }
        .notification.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        .modal.active {
            display: flex;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .modal-content {
            background: linear-gradient(135deg, #fef2f2, #ffffff);
            padding: 1.5rem;
            border-radius: 1.5rem;
            max-width: 400px;
            width: 90%;
            position: relative;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            text-align: center;
            animation: slideIn 0.4s ease;
        }
        .modal-content.checkout {
            max-width: 350px;
            padding: 1rem;
            text-align: left;
        }
        .modal-content.cart {
            max-width: 450px;
            text-align: left;
            display: flex;
            flex-direction: column;
            max-height: 80vh;
        }
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .modal-content .pizza-icon {
            font-size: 2.5rem;
            color: #dc2626;
            margin-bottom: 0.5rem;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .modal-content h2 {
            font-size: 1.75rem;
            font-weight: 700;
            color: #dc2626;
            margin-bottom: 0.75rem;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        .modal-content h2 i {
            color: #dc2626;
            font-size: 2rem;
            transition: transform 0.3s;
        }
        .modal-content h2 i:hover {
            transform: rotate(15deg);
        }
        .modal-content.checkout h2, .modal-content.cart h2 {
            font-size: 1.5rem;
            margin-bottom: 0.75rem;
            text-align: left;
            justify-content: flex-start;
        }
        .modal-content select, .modal-content input {
            width: 100%;
            padding: 0.5rem 2rem 0.5rem 0.75rem;
            margin-bottom: 0.75rem;
            border: 1px solid #dc2626;
            border-radius: 0.75rem;
            font-size: 0.875rem;
            background: #fff url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="%23dc2626"><path d="M7 7l3-3 3 3m0 6l-3 3-3-3"/></svg>') no-repeat right 0.75rem center/12px;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .modal-content select:focus, .modal-content input:focus {
            border-color: #16a34a;
            box-shadow: inset 0 0 6px rgba(22, 163, 74, 0.2);
            outline: none;
        }
        .modal-content button {
            padding: 0.5rem 1.5rem;
            border-radius: 0.75rem;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.875rem;
            transition: transform 0.2s, box-shadow 0.2s, background 0.2s;
        }
        .modal-content button:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        .modal-content .close {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            font-size: 1.5rem;
            color: #dc2626;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .modal-content .close:hover {
            transform: rotate(90deg);
        }
        .modal-content .btn-primary {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
        }
        .modal-content .btn-primary:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        .modal-content .btn-secondary {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: white;
        }
        .modal-content.checkout .button-group, .modal-content.cart .button-group {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }
        .modal-content .button-group {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-top: 0.75rem;
        }
        .loading-bar {
            width: 100%;
            height: 6px;
            background-color: #fee2e2;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 0.75rem;
        }
        .loading-bar div {
            width: 0;
            height: 100%;
            background: linear-gradient(135deg, #dc2626, #16a34a);
            animation: loading 1.5s ease-in-out infinite;
        }
        @keyframes loading {
            0% { width: 0; transform: translateX(0); }
            50% { width: 100%; transform: translateX(0); }
            100% { width: 100%; transform: translateX(100%); }
        }
        .progress-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            position: relative;
        }
        .progress-step {
            width: 30px;
            height: 30px;
            background-color: #d1d5db;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 600;
            z-index: 1;
            transition: background-color 0.3s;
        }
        .progress-step.active {
            background-color: #dc2626;
        }
        .progress-line {
            position: absolute;
            top: 50%;
            left: 30px;
            right: 30px;
            height: 4px;
            background-color: #d1d5db;
            transform: translateY(-50%);
            z-index: 0;
        }
        .progress-line-fill {
            height: 100%;
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            width: 0;
            transition: width 0.3s ease;
        }
        .searching-animation {
            font-size: 2rem;
            color: #dc2626;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
            display: block;
        }
        .cart-summary {
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
        }
        .cart-summary p {
            font-size: 0.875rem;
            color: #4b5563;
        }
        .cart-summary strong {
            color: #dc2626;
            font-size: 1.25rem;
        }
        .cart-items-container {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 1rem;
        }
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
            background-color: #fff;
        }
        .cart-item-details {
            flex: 1;
        }
        .cart-item-details p {
            font-size: 0.875rem;
            color: #1f2937;
            margin: 0.25rem 0;
        }
        .cart-item-details select {
            width: auto;
            display: block;
            margin-top: 0.25rem;
        }
        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .cart-item-controls button {
            width: 30px;
            height: 30px;
            padding: 0;
            font-size: 0.875rem;
            border-radius: 0.5rem;
        }
        .cart-item-controls .remove-btn {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
        }
        .cart-item-controls .remove-btn i {
            transition: transform 0.2s;
        }
        .cart-item-controls .remove-btn:hover i {
            transform: rotate(15deg);
        }
        .cart-footer {
            padding-top: 0.5rem;
            border-top: 1px solid #e5e7eb;
            position: sticky;
            bottom: 0;
            background: #fff;
        }
        #min-order-error {
            font-size: 0.75rem;
            margin-bottom: 0.5rem;
        }
        @media (max-width: 640px) {
            .logo {
                width: 100px;
                height: 100px;
            }
            header h1 {
                font-size: 1.5rem;
            }
            .menu-item {
                flex-direction: column;
                text-align: center;
            }
            .menu-img {
                width: 100px;
                height: 100px;
            }
            .category-bar {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            .category-bar button {
                padding: 0.5rem;
                font-size: 0.875rem;
            }
            .modal-content {
                max-width: 350px;
            }
            .modal-content.checkout, .modal-content.cart {
                max-width: 300px;
            }
            .cart-item {
                flex-direction: column;
                align-items: flex-start;
            }
            .cart-item-controls {
                margin-top: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Logo La Casa de Pizza's">
        </div>
        <span class="status">ABERTO</span>
        <h1>La Casa de Pizza's</h1>
        <p>Pedido Mínimo R$ 10,00 | 30-50 min</p>
        <p id="location-display">Detectando sua localização...</p>
        <p>4,9 (2.136 avaliações)</p>
    </header>
    <div class="category-bar">
        <button onclick="scrollToSection('combos')">Combos</button>
        <button onclick="scrollToSection('pizzas-artesanais')">Pizzas Tradicionais</button>
        <button onclick="scrollToSection('pizzas-doces')">Pizzas Doces</button>
    </div>
    <section id="combos" class="menu-section">
        <h2>Combos</h2>
        <div class="menu-item" aria-label="Combo La Casa de Pizza's Casal">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem do Combo Casal" class="menu-img">
            <div>
                <span class="discount-tag">SOMENTE HOJE 35% OFF</span>
                <h3 class="text-lg font-semibold">Combo La Casa de Pizza's Casal</h3>
                <p>1 Pizza Grande Tradicional + 1 Pizza Doce Média + 1 Refrigerante 1,5L</p>
                <p><span class="price-old">de R$ 63,80</span> <span class="price-new">por R$ 41,90</span></p>
                <p class="availability">🔥 Apenas 10 combos com esse preço especial</p>
                <p class="stock-info" data-stock-key="casal">Restam 10 unidades</p>
                <button class="add-to-cart" data-name="Combo La Casa de Pizza's Casal" data-price="41.90" data-stock-key="casal" data-is-combo="true" data-pizza-count="2" aria-label="Adicionar Combo La Casa de Pizza's Casal ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
        <div class="menu-item" aria-label="Combo La Casa de Pizza's Familia">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem do Combo Familia" class="menu-img">
            <div>
                <span class="discount-tag">SOMENTE HOJE 40% OFF</span>
                <h3 class="text-lg font-semibold">Combo La Casa de Pizza's Familia</h3>
                <p>2 Pizzas Grandes Tradicionais + 1 Pizza Doce Média + 1 Refrigerante 2L</p>
                <p><span class="price-old">de R$ 95,80</span> <span class="price-new">por R$ 64,90</span></p>
                <p class="availability">🔥 Apenas 10 combos com esse preço especial</p>
                <p class="stock-info" data-stock-key="familia">Restam 10 unidades</p>
                <button class="add-to-cart" data-name="Combo La Casa de Pizza's Familia" data-price="64.90" data-stock-key="familia" data-is-combo="true" data-pizza-count="3" aria-label="Adicionar Combo La Casa de Pizza's Familia ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
        <div class="menu-item" aria-label="Combo La Casa de Pizza's Supremo">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem do Combo Supremo" class="menu-img">
            <div>
                <span class="discount-tag">SOMENTE HOJE 60% OFF</span>
                <h3 class="text-lg font-semibold">Combo La Casa de Pizza's Supremo</h3>
                <p>3 Pizzas Grandes Tradicionais + 1 Pizza Doce Grande + 2 Refrigerantes 2L + 1 Porção de Batata Frita + 1 Pão de Alho</p>
                <p><span class="price-old">de R$ 300,00</span> <span class="price-new">por R$ 120,00</span></p>
                <p class="availability">🔥 Quantidade limitada</p>
                <p class="stock-info" data-stock-key="supremo">Restam 5 unidades</p>
                <button class="add-to-cart" data-name="Combo La Casa de Pizza's Supremo" data-price="120.00" data-stock-key="supremo" data-is-combo="true" data-pizza-count="4" aria-label="Adicionar Combo La Casa de Pizza's Supremo ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
    </section>
    <section id="pizzas-artesanais" class="menu-section">
        <h2>Pizzas Artesanais</h2>
        <div class="menu-item" aria-label="Pizza de Calabresa">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem da Pizza de Calabresa" class="menu-img">
            <div>
                <h3 class="text-lg font-semibold">Pizza de Calabresa</h3>
                <p>Calabresa fatiada artesanal, cebola caramelizada, muçarela de búfala, orégano fresco, azeitonas pretas, pimentão vermelho assado, manjericão e toque de azeite trufado</p>
                <p class="price-new">R$ 42,90</p>
                <p class="stock-info" data-stock-key="calabresa">Restam 20 unidades</p>
                <button class="add-to-cart" data-name="Pizza de Calabresa" data-price="42.90" data-stock-key="calabresa" data-is-combo="false" aria-label="Adicionar Pizza de Calabresa ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
        <div class="menu-item" aria-label="Pizza Margherita">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem da Pizza Margherita" class="menu-img">
            <div>
                <h3 class="text-lg font-semibold">Pizza Margherita</h3>
                <p>Molho de tomate San Marzano, muçarela de búfala, manjericão fresco, parmesão ralado, azeite de oliva extra virgem, tomate cereja confit e rúcula selvagem</p>
                <p class="price-new">R$ 45,90</p>
                <p class="stock-info" data-stock-key="margherita">Restam 20 unidades</p>
                <button class="add-to-cart" data-name="Pizza Margherita" data-price="45.90" data-stock-key="margherita" data-is-combo="false" aria-label="Adicionar Pizza Margherita ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
        <div class="menu-item" aria-label="Pizza Quatro Queijos">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem da Pizza Quatro Queijos" class="menu-img">
            <div>
                <h3 class="text-lg font-semibold">Pizza Quatro Queijos</h3>
                <p>Muçarela, parmesão, gorgonzola, catupiry artesanal, toque de mel trufado, nozes picadas, cebola crocante e ervas finas</p>
                <p class="price-new">R$ 48,90</p>
                <p class="stock-info" data-stock-key="quatroqueijos">Restam 20 unidades</p>
                <button class="add-to-cart" data-name="Pizza Quatro Queijos" data-price="48.90" data-stock-key="quatroqueijos" data-is-combo="false" aria-label="Adicionar Pizza Quatro Queijos ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
        <div class="menu-item" aria-label="Pizza Suprema">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem da Pizza Suprema" class="menu-img">
            <div>
                <h3 class="text-lg font-semibold">Pizza Suprema</h3>
                <p>Pepperoni artesanal, muçarela, bacon crocante, champignon fatiado, cebola roxa, pimentão verde, azeitonas verdes, molho de tomate rústico e orégano</p>
                <p class="price-new">R$ 49,90</p>
                <p class="stock-info" data-stock-key="suprema">Restam 15 unidades</p>
                <button class="add-to-cart" data-name="Pizza Suprema" data-price="49.90" data-stock-key="suprema" data-is-combo="false" aria-label="Adicionar Pizza Suprema ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
        <div class="menu-item" aria-label="Pizza Frango com Catupiry">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem da Pizza Frango com Catupiry" class="menu-img">
            <div>
                <h3 class="text-lg font-semibold">Pizza Frango com Catupiry</h3>
                <p>Frango desfiado temperado, catupiry artesanal, muçarela, milho verde, tomate em cubos, cebolinha fresca, azeitonas pretas e toque de páprica defumada</p>
                <p class="price-new">R$ 46,90</p>
                <p class="stock-info" data-stock-key="frangocatupiry">Restam 15 unidades</p>
                <button class="add-to-cart" data-name="Pizza Frango com Catupiry" data-price="46.90" data-stock-key="frangocatupiry" data-is-combo="false" aria-label="Adicionar Pizza Frango com Catupiry ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
        <div class="menu-item" aria-label="Pizza Portuguesa">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem da Pizza Portuguesa" class="menu-img">
            <div>
                <h3 class="text-lg font-semibold">Pizza Portuguesa</h3>
                <p>Presunto cozido, muçarela, ovo cozido fatiado, cebola crua, pimentão amarelo, azeitonas verdes, tomate fatiado, ervilha fresca e molho de tomate</p>
                <p class="price-new">R$ 47,90</p>
                <p class="stock-info" data-stock-key="portuguesa">Restam 15 unidades</p>
                <button class="add-to-cart" data-name="Pizza Portuguesa" data-price="47.90" data-stock-key="portuguesa" data-is-combo="false" aria-label="Adicionar Pizza Portuguesa ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
    </section>
    <section id="pizzas-doces" class="menu-section">
        <h2>Pizzas Doces</h2>
        <div class="menu-item" aria-label="Pizza de Chocolate">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem da Pizza de Chocolate" class="menu-img">
            <div>
                <h3 class="text-lg font-semibold">Pizza de Chocolate</h3>
                <p>Chocolate ao leite derretido, granulado belga, morangos frescos, chantilly artesanal, amêndoas laminadas e calda de chocolate meio amargo</p>
                <p class="price-new">R$ 32,90</p>
                <p class="stock-info" data-stock-key="chocolate">Restam 15 unidades</p>
                <button class="add-to-cart" data-name="Pizza de Chocolate" data-price="32.90" data-stock-key="chocolate" data-is-combo="false" aria-label="Adicionar Pizza de Chocolate ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
        <div class="menu-item" aria-label="Pizza de Brigadeiro">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem da Pizza de Brigadeiro" class="menu-img">
            <div>
                <h3 class="text-lg font-semibold">Pizza de Brigadeiro</h3>
                <p>Brigadeiro gourmet, chocolate granulado, amendoim torrado, raspas de chocolate meio amargo, banana caramelizada e toque de canela</p>
                <p class="price-new">R$ 34,90</p>
                <p class="stock-info" data-stock-key="brigadeiro">Restam 15 unidades</p>
                <button class="add-to-cart" data-name="Pizza de Brigadeiro" data-price="34.90" data-stock-key="brigadeiro" data-is-combo="false" aria-label="Adicionar Pizza de Brigadeiro ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
        <div class="menu-item" aria-label="Pizza de Doce de Leite">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem da Pizza de Doce de Leite" class="menu-img">
            <div>
                <h3 class="text-lg font-semibold">Pizza de Doce de Leite</h3>
                <p>Doce de leite artesanal, muçarela derretida, coco ralado, castanha-de-caju picada, calda de caramelo e toque de flor de sal</p>
                <p class="price-new">R$ 35,90</p>
                <p class="stock-info" data-stock-key="docedeleite">Restam 10 unidades</p>
                <button class="add-to-cart" data-name="Pizza de Doce de Leite" data-price="35.90" data-stock-key="docedeleite" data-is-combo="false" aria-label="Adicionar Pizza de Doce de Leite ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
        <div class="menu-item" aria-label="Pizza de Prestígio">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem da Pizza de Prestígio" class="menu-img">
            <div>
                <h3 class="text-lg font-semibold">Pizza de Prestígio</h3>
                <p>Chocolate amargo, coco ralado fresco, leite condensado, amêndoas torradas, morangos fatiados e chantilly</p>
                <p class="price-new">R$ 36,90</p>
                <p class="stock-info" data-stock-key="prestigio">Restam 10 unidades</p>
                <button class="add-to-cart" data-name="Pizza de Prestígio" data-price="36.90" data-stock-key="prestigio" data-is-combo="false" aria-label="Adicionar Pizza de Prestígio ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
        <div class="menu-item" aria-label="Pizza de Romeu e Julieta">
            <img src="https://imgur.com/3wbh5W3.jpeg" alt="Imagem da Pizza de Romeu e Julieta" class="menu-img">
            <div>
                <h3 class="text-lg font-semibold">Pizza de Romeu e Julieta</h3>
                <p>Goiabada cremosa, queijo minas padrão derretido, catupiry artesanal, hortelã fresca, castanhas trituradas e açúcar de confeiteiro</p>
                <p class="price-new">R$ 33,90</p>
                <p class="stock-info" data-stock-key="romeuejulieta">Restam 10 unidades</p>
                <button class="add-to-cart" data-name="Pizza de Romeu e Julieta" data-price="33.90" data-stock-key="romeuejulieta" data-is-combo="false" aria-label="Adicionar Pizza de Romeu e Julieta ao carrinho">Adicionar ao Carrinho</button>
            </div>
        </div>
    </section>
    <button id="cart-toggle-btn" aria-label="Abrir carrinho">
        <i class="fas fa-shopping-cart"></i>
        <span id="cart-count">0</span>
    </button>
    <div id="notification" class="notification" aria-live="assertive"></div>
    <div id="state-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('state-modal')">×</span>
            <div class="progress-bar">
                <div class="progress-step active">1</div>
                <div class="progress-step">2</div>
                <div class="progress-step">3</div>
                <div class="progress-step">4</div>
                <div class="progress-line"><div class="progress-line-fill" style="width: 0%"></div></div>
            </div>
            <i class="fas fa-pizza-slice pizza-icon"></i>
            <h2><i class="fas fa-map-marker-alt"></i> Escolha seu Estado</h2>
            <div class="loading-bar" id="state-loading" style="display: none;"><div></div></div>
            <select id="state-select">
                <option value="">Selecione um estado</option>
            </select>
            <div class="button-group">
                <button class="btn-primary" onclick="openCityModal()" disabled id="state-next-btn">Próximo</button>
            </div>
        </div>
    </div>
    <div id="city-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('city-modal')">×</span>
            <div class="progress-bar">
                <div class="progress-step active">1</div>
                <div class="progress-step active">2</div>
                <div class="progress-step">3</div>
                <div class="progress-step">4</div>
                <div class="progress-line"><div class="progress-line-fill" style="width: 33.33%"></div></div>
            </div>
            <i class="fas fa-pizza-slice pizza-icon"></i>
            <h2><i class="fas fa-city"></i> Escolha sua Cidade</h2>
            <div class="loading-bar" id="city-loading" style="display: none;"><div></div></div>
            <select id="city-select">
                <option value="">Selecione uma cidade</option>
            </select>
            <div class="button-group">
                <button class="btn-secondary" onclick="openStateModal()">Voltar</button>
                <button class="btn-primary" onclick="openSearchingModal()" disabled id="city-next-btn">Próximo</button>
            </div>
        </div>
    </div>
    <div id="searching-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('searching-modal')">×</span>
            <div class="progress-bar">
                <div class="progress-step active">1</div>
                <div class="progress-step active">2</div>
                <div class="progress-step active">3</div>
                <div class="progress-step">4</div>
                <div class="progress-line"><div class="progress-line-fill" style="width: 66.67%"></div></div>
            </div>
            <i class="fas fa-pizza-slice pizza-icon"></i>
            <h2><i class="fas fa-search-location"></i> Procurando Loja</h2>
            <p id="searching-text">Procurando loja mais próxima de...</p>
            <i class="fas fa-spinner searching-animation"></i>
        </div>
    </div>
    <div id="found-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('found-modal')">×</span>
            <div class="progress-bar">
                <div class="progress-step active">1</div>
                <div class="progress-step active">2</div>
                <div class="progress-step active">3</div>
                <div class="progress-step active">4</div>
                <div class="progress-line"><div class="progress-line-fill" style="width: 100%"></div></div>
            </div>
            <i class="fas fa-pizza-slice pizza-icon"></i>
            <h2><i class="fas fa-store"></i> Loja Encontrada</h2>
            <p id="found-text">Loja mais próxima encontrada a 1,6 km</p>
            <div class="button-group">
                <button class="btn-secondary" onclick="openCityModal()">Voltar</button>
                <button class="btn-primary" onclick="confirmLocation()">Confirmar</button>
            </div>
        </div>
    </div>
    <div id="cart-modal" class="modal">
        <div class="modal-content cart">
            <span class="close" onclick="closeModal('cart-modal')">×</span>
            <h2><i class="fas fa-shopping-cart"></i> Carrinho</h2>
            <div class="cart-summary">
                <p>Itens: <span id="cart-item-count">0</span> | Total: R$<span id="cart-total">0.00</span></p>
            </div>
            <div class="cart-items-container" id="cart-items"></div>
            <div class="cart-footer">
                <p id="min-order-error" style="color: #dc2626; display: none;">O pedido mínimo é R$ 10,00</p>
                <div class="button-group">
                    <button class="btn-secondary" onclick="clearCart()">Limpar</button>
                    <button class="btn-primary" onclick="openCheckoutModal()" disabled id="checkout-btn">Finalizar</button>
                </div>
            </div>
        </div>
    </div>
    <div id="checkout-modal" class="modal">
        <div class="modal-content checkout">
            <span class="close" onclick="closeModal('checkout-modal')">×</span>
            <h2><i class="fas fa-check-circle"></i> Finalizar Pedido</h2>
            <input type="text" id="name" placeholder="Nome" aria-label="Nome">
            <input type="text" id="address" placeholder="Endereço" aria-label="Endereço">
            <input type="text" id="phone" placeholder="Telefone" aria-label="Telefone">
            <div class="button-group">
                <button class="btn-secondary" onclick="openCartModal()">Voltar</button>
                <button class="btn-primary" onclick="confirmCheckout()">Confirmar</button>
            </div>
        </div>
    </div>
    <script>
        // Configurações
        const config = {
            whatsapp: '+5562995771104',
            logo: 'https://imgur.com/3wbh5W3.jpeg',
            images: {
                comboCasal: 'https://imgur.com/3wbh5W3.jpeg',
                comboFamilia: 'https://imgur.com/3wbh5W3.jpeg',
                comboSupremo: 'https://imgur.com/3wbh5W3.jpeg',
                pizzaCalabresa: 'https://imgur.com/3wbh5W3.jpeg',
                pizzaMargherita: 'https://imgur.com/3wbh5W3.jpeg',
                pizzaQuatroQueijos: 'https://imgur.com/3wbh5W3.jpeg',
                pizzaSuprema: 'https://imgur.com/3wbh5W3.jpeg',
                pizzaFrangoCatupiry: 'https://imgur.com/3wbh5W3.jpeg',
                pizzaPortuguesa: 'https://imgur.com/3wbh5W3.jpeg',
                pizzaChocolate: 'https://imgur.com/3wbh5W3.jpeg',
                pizzaBrigadeiro: 'https://imgur.com/3wbh5W3.jpeg',
                pizzaDoceDeLeite: 'https://imgur.com/3wbh5W3.jpeg',
                pizzaPrestigio: 'https://imgur.com/3wbh5W3.jpeg',
                pizzaRomeuEJulieta: 'https://imgur.com/3wbh5W3.jpeg'
            }
        };

        // Dados
        let cartItems = [];
        let selectedCity = '';
        let selectedState = '';
        const flavors = {
            traditional: ['Calabresa', 'Margherita', 'Quatro Queijos', 'Suprema', 'Frango com Catupiry', 'Portuguesa'],
            sweet: ['Chocolate', 'Brigadeiro', 'Doce de Leite', 'Prestígio', 'Romeu e Julieta']
        };
        const borders = [
            { name: 'Sem borda', price: 0 },
            { name: 'Catupiry', price: 5 },
            { name: 'Cheddar', price: 5 },
            { name: 'Gorgonzola', price: 5 },
            { name: 'Chocolate', price: 6 },
            { name: 'Doce de Leite', price: 6 }
        ];
        const comboPizzaCounts = {
            'Combo La Casa de Pizza\'s Casal': [
                { type: 'traditional', size: 'Grande' },
                { type: 'sweet', size: 'Média' }
            ],
            'Combo La Casa de Pizza\'s Familia': [
                { type: 'traditional', size: 'Grande' },
                { type: 'traditional', size: 'Grande' },
                { type: 'sweet', size: 'Média' }
            ],
            'Combo La Casa de Pizza\'s Supremo': [
                { type: 'traditional', size: 'Grande' },
                { type: 'traditional', size: 'Grande' },
                { type: 'traditional', size: 'Grande' },
                { type: 'sweet', size: 'Grande' }
            ]
        };
        const fallbackStates = [
            { sigla: 'GO', nome: 'Goiás', id: 52, cities: ['Goiânia', 'Anápolis'] },
            { sigla: 'SP', nome: 'São Paulo', id: 35, cities: ['São Paulo', 'Campinas'] }
        ];

        // Funções de modal
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('active');
                console.log(`Modal ${modalId} aberto`);
            } else {
                console.error(`Modal com ID ${modalId} não encontrado`);
                showNotification(`Erro: Modal ${modalId} não encontrado`, true);
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
                console.log(`Modal ${modalId} fechado`);
            } else {
                console.error(`Modal com ID ${modalId} não encontrado`);
            }
        }

        function openStateModal() {
            closeModal('city-modal');
            closeModal('searching-modal');
            closeModal('found-modal');
            openModal('state-modal');
            loadStates();
        }

        function openCityModal() {
            const stateSelect = document.getElementById('state-select');
            if (stateSelect && stateSelect.value) {
                closeModal('state-modal');
                openModal('city-modal');
                loadCities();
            } else {
                showNotification('Selecione um estado primeiro!', true);
            }
        }

        function openSearchingModal() {
            const citySelect = document.getElementById('city-select');
            if (citySelect && citySelect.value) {
                selectedCity = citySelect.value;
                selectedState = document.getElementById('state-select')?.value || '';
                document.getElementById('searching-text').textContent = `Procurando loja mais próxima de ${selectedCity}...`;
                closeModal('city-modal');
                openModal('searching-modal');
                setTimeout(() => {
                    closeModal('searching-modal');
                    openFoundModal();
                }, 2000);
            } else {
                showNotification('Selecione uma cidade primeiro!', true);
            }
        }

        function openFoundModal() {
            const foundText = document.getElementById('found-text');
            if (foundText) {
                foundText.textContent = `Loja mais próxima de ${selectedCity} encontrada a 1,6 km`;
                openModal('found-modal');
            } else {
                console.error('Elemento found-text não encontrado');
                showNotification('Erro ao exibir modal de loja encontrada', true);
            }
        }

        function openCartModal() {
            closeModal('checkout-modal');
            openModal('cart-modal');
            updateCartDisplay();
        }

        function openCheckoutModal() {
            const total = cartItems.reduce((sum, item) => sum + item.price * item.quantity, 0);
            if (total < 10) {
                document.getElementById('min-order-error').style.display = 'block';
                return;
            }
            if (!selectedCity || !selectedState) {
                showNotification('Selecione sua localização primeiro!', true);
                openModal('state-modal');
                return;
            }
            closeModal('cart-modal');
            openModal('checkout-modal');
        }

        // Funções de localização
        async function loadStates() {
            console.log('loadStates chamado');
            const stateModal = document.getElementById('state-modal');
            const stateSelect = document.getElementById('state-select');
            const stateLoading = document.getElementById('state-loading');

            if (!stateModal || !stateSelect || !stateLoading) {
                console.error('Elementos necessários não encontrados:', {
                    stateModal: !!stateModal,
                    stateSelect: !!stateSelect,
                    stateLoading: !!stateLoading
                });
                showNotification('Erro ao carregar estados: interface não encontrada', true);
                if (stateSelect) {
                    stateSelect.innerHTML = '<option value="">Selecione um estado</option>' + 
                        fallbackStates.map(s => `<option value="${s.sigla}" data-id="${s.id}">${s.nome}</option>`).join('');
                }
                return;
            }

            stateLoading.style.display = 'block';
            try {
                const response = await fetch('https://servicodados.ibge.gov.br/api/v1/localidades/estados');
                if (!response.ok) throw new Error('Erro ao carregar estados');
                const states = await response.json();
                stateSelect.innerHTML = '<option value="">Selecione um estado</option>' + 
                    states.sort((a, b) => a.nome.localeCompare(b.nome))
                        .map(s => `<option value="${s.sigla}" data-id="${s.id}">${s.nome}</option>`).join('');
            } catch (error) {
                console.error('Erro ao carregar estados:', error);
                showNotification('Erro ao carregar estados, usando lista padrão.', true);
                stateSelect.innerHTML = '<option value="">Selecione um estado</option>' + 
                    fallbackStates.map(s => `<option value="${s.sigla}" data-id="${s.id}">${s.nome}</option>`).join('');
            }
            stateLoading.style.display = 'none';
            const stateNextBtn = document.getElementById('state-next-btn');
            if (stateNextBtn) {
                stateNextBtn.disabled = !stateSelect.value;
            }
        }

        async function loadCities() {
            console.log('loadCities chamado');
            const stateSelect = document.getElementById('state-select');
            const stateId = stateSelect?.selectedOptions[0]?.dataset.id;
            const citySelect = document.getElementById('city-select');
            const cityLoading = document.getElementById('city-loading');
            if (!citySelect || !cityLoading) {
                console.error('Elementos city-select ou city-loading não encontrados');
                showNotification('Erro ao carregar cidades: interface não encontrada', true);
                return;
            }
            citySelect.innerHTML = '<option value="">Selecione uma cidade</option>';
            cityLoading.style.display = 'block';
            try {
                if (stateId) {
                    const response = await fetch(`https://servicodados.ibge.gov.br/api/v1/localidades/estados/${stateId}/municipios`);
                    if (!response.ok) throw new Error('Erro ao carregar cidades');
                    const cities = await response.json();
                    citySelect.innerHTML = '<option value="">Selecione uma cidade</option>' + 
                        cities.sort((a, b) => a.nome.localeCompare(b.nome))
                            .map(c => `<option value="${c.nome}">${c.nome}</option>`).join('');
                } else {
                    throw new Error('Estado não selecionado');
                }
            } catch (error) {
                console.error('Erro ao carregar cidades:', error);
                showNotification('Erro ao carregar cidades, usando lista padrão.', true);
                const fallback = fallbackStates.find(s => s.sigla === stateSelect?.value);
                if (fallback) {
                    citySelect.innerHTML = '<option value="">Selecione uma cidade</option>' + 
                        fallback.cities.map(c => `<option value="${c}">${c}</option>`).join('');
                }
            }
            cityLoading.style.display = 'none';
            const cityNextBtn = document.getElementById('city-next-btn');
            if (cityNextBtn) {
                cityNextBtn.disabled = !citySelect.value;
            }
        }

        function confirmLocation() {
            if (selectedCity && selectedState) {
                const locationDisplay = document.getElementById('location-display');
                if (locationDisplay) {
                    locationDisplay.textContent = `Você está em ${selectedCity}, ${selectedState}`;
                }
                showNotification('Localização confirmada!');
                closeModal('found-modal');
            } else {
                showNotification('Erro: Localização não selecionada', true);
            }
        }

        // Funções do carrinho
        function addToCart(button) {
            console.log('addToCart chamado para:', button.dataset.name);
            if (!selectedCity || !selectedState) {
                showNotification('Selecione sua localização primeiro!', true);
                openModal('state-modal');
                return;
            }

            const requiredAttributes = ['name', 'price', 'stockKey', 'isCombo'];
            for (const attr of requiredAttributes) {
                if (!button.dataset[attr]) {
                    console.error(`Atributo dataset.${attr} ausente no botão`, button);
                    showNotification('Erro ao adicionar item ao carrinho!', true);
                    return;
                }
            }

            button.classList.add('loading');
            try {
                const isCombo = button.dataset.isCombo === 'true';
                const pizzaCount = parseInt(button.dataset.pizzaCount) || 1;
                const basePrice = parseFloat(button.dataset.price);
                const stockKey = button.dataset.stockKey;

                let pizzas = [];
                if (isCombo) {
                    if (!comboPizzaCounts[button.dataset.name]) {
                        throw new Error(`Configuração de combo não encontrada para ${button.dataset.name}`);
                    }
                    pizzas = comboPizzaCounts[button.dataset.name].map(pizzaConfig => ({
                        flavor: pizzaConfig.type === 'traditional' ? flavors.traditional[0] : flavors.sweet[0],
                        border: borders[0].name,
                        type: pizzaConfig.type,
                        size: pizzaConfig.size
                    }));
                } else {
                    pizzas = [{
                        flavor: button.dataset.name,
                        border: borders[0].name,
                        type: flavors.traditional.includes(button.dataset.name) ? 'traditional' : 'sweet',
                        size: 'Grande'
                    }];
                }

                const item = {
                    id: Date.now(),
                    name: button.dataset.name,
                    basePrice: basePrice,
                    price: basePrice,
                    stockKey: stockKey,
                    quantity: 1,
                    isCombo: isCombo,
                    pizzas: pizzas,
                    comboBorderPrice: isCombo ? 0 : undefined
                };

                console.log('Item a ser adicionado:', item);

                const existingItem = cartItems.find(i => 
                    i.name === item.name && 
                    JSON.stringify(i.pizzas) === JSON.stringify(item.pizzas)
                );
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cartItems.push(item);
                }

                updateCartDisplay();
                showNotification(`${item.name} adicionado ao carrinho!`);
            } catch (error) {
                console.error('Erro ao adicionar ao carrinho:', error);
                showNotification('Erro ao adicionar item ao carrinho!', true);
            } finally {
                button.classList.remove('loading');
            }
        }

        function updateCartDisplay() {
            console.log('updateCartDisplay chamado, cartItems:', cartItems);
            const cartCountElement = document.getElementById('cart-count');
            const cartItemCountElement = document.getElementById('cart-item-count');
            const cartItemsDiv = document.getElementById('cart-items');
            const cartTotalElement = document.getElementById('cart-total');
            const minOrderErrorElement = document.getElementById('min-order-error');
            const checkoutBtnElement = document.getElementById('checkout-btn');

            if (!cartItemsDiv || !cartCountElement || !cartItemCountElement || !cartTotalElement || !minOrderErrorElement || !checkoutBtnElement) {
                console.error('Um ou mais elementos do carrinho não foram encontrados');
                showNotification('Erro ao atualizar carrinho!', true);
                return;
            }

            const cartCount = cartItems.reduce((sum, item) => sum + item.quantity, 0);
            cartCountElement.textContent = cartCount;
            cartItemCountElement.textContent = cartCount;

            cartItemsDiv.innerHTML = cartItems.length === 0 ? '<p>Carrinho vazio</p>' : '';
            cartItems.forEach(item => {
                const div = document.createElement('div');
                div.className = 'cart-item';
                let details = `
                    <div class="cart-item-details">
                        <p><strong>${item.name}</strong> - R$${item.price.toFixed(2)} x ${item.quantity}</p>
                `;
                item.pizzas.forEach((pizza, index) => {
                    details += `
                        <p>Pizza ${index + 1} (${pizza.size} ${pizza.type === 'traditional' ? 'Tradicional' : 'Doce'}):</p>
                    `;
                    if (item.isCombo) {
                        details += `
                            <select onchange="updatePizzaFlavor(${item.id}, ${index}, this.value)">
                                ${flavors[pizza.type].map(f => `<option value="${f}" ${pizza.flavor === f ? 'selected' : ''}>${f}</option>`).join('')}
                            </select>
                        `;
                    } else {
                        details += `<p>Sabor: ${pizza.flavor}</p>`;
                    }
                    details += `
                        <select onchange="updatePizzaBorder(${item.id}, ${index}, this.value, parseFloat(this.selectedOptions[0].dataset.price))">
                            ${borders.map(b => `<option value="${b.name}" data-price="${b.price}" ${pizza.border === b.name ? 'selected' : ''}>${b.name}</option>`).join('')}
                        </select>
                    `;
                });
                details += '</div>';
                div.innerHTML = `
                    ${details}
                    <div class="cart-item-controls">
                        <button onclick="updateQuantity(${item.id}, -1)" aria-label="Diminuir quantidade">-</button>
                        <button onclick="updateQuantity(${item.id}, 1)" aria-label="Aumentar quantidade">+</button>
                        <button class="remove-btn" onclick="removeFromCart(${item.id})" aria-label="Remover item"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                cartItemsDiv.appendChild(div);
            });

            const total = cartItems.reduce((sum, item) => sum + item.price * item.quantity, 0);
            cartTotalElement.textContent = total.toFixed(2);
            minOrderErrorElement.style.display = total < 10 && cartItems.length > 0 ? 'block' : 'none';
            checkoutBtnElement.disabled = cartItems.length === 0 || total < 10;
        }

        function updateQuantity(id, change) {
            const item = cartItems.find(i => i.id === id);
            if (!item) return;
            if (change < 0 && item.quantity <= 1) {
                removeFromCart(id);
                return;
            }
            item.quantity += change;
            updateCartDisplay();
        }

        function removeFromCart(id) {
            cartItems = cartItems.filter(i => i.id !== id);
            updateCartDisplay();
        }

        function clearCart() {
            cartItems = [];
            updateCartDisplay();
        }

        function updatePizzaFlavor(id, pizzaIndex, flavor) {
            const item = cartItems.find(i => i.id === id);
            if (item && item.pizzas[pizzaIndex]) {
                item.pizzas[pizzaIndex].flavor = flavor;
                updateCartDisplay();
            }
        }

        function updatePizzaBorder(id, pizzaIndex, border, price) {
            const item = cartItems.find(i => i.id === id);
            if (!item || !item.pizzas[pizzaIndex]) return;
            
            const oldBorder = borders.find(b => b.name === item.pizzas[pizzaIndex].border);
            const oldBorderPrice = oldBorder ? oldBorder.price : 0;
            item.pizzas[pizzaIndex].border = border;
            
            if (item.isCombo) {
                const maxBorderPrice = Math.max(...item.pizzas.map(p => {
                    const b = borders.find(b => b.name === p.border);
                    return b ? b.price : 0;
                }));
                item.price = item.basePrice + maxBorderPrice;
                item.comboBorderPrice = maxBorderPrice;
            } else {
                item.price += (price - oldBorderPrice) / item.quantity;
            }
            updateCartDisplay();
        }

        function confirmCheckout() {
            const nameInput = document.getElementById('name');
            const addressInput = document.getElementById('address');
            const phoneInput = document.getElementById('phone');
            if (!nameInput || !addressInput || !phoneInput) {
                console.error('Campos de checkout não encontrados');
                showNotification('Erro ao finalizar pedido: campos não encontrados', true);
                return;
            }
            const name = nameInput.value.trim();
            const address = addressInput.value.trim();
            const phone = phoneInput.value.trim();
            if (!name || !address || !phone) {
                showNotification('Preencha todos os campos!', true);
                return;
            }
            const total = cartItems.reduce((sum, item) => sum + item.price * item.quantity, 0);
            let message = `🍕 *Novo Pedido - La Casa de Pizza's* 🍕\n\n`;
            message += `*Cliente*: ${name}\n`;
            message += `*Telefone*: ${phone}\n`;
            message += `*Endereço*: ${address}, ${selectedCity}, ${selectedState}\n\n`;
            message += `*Itens do Pedido*:\n`;
            cartItems.forEach(item => {
                message += `• ${item.name} (x${item.quantity})\n`;
                item.pizzas.forEach((pizza, i) => {
                    message += `  - Pizza ${i + 1}: ${pizza.flavor} (${pizza.size}, ${pizza.type === 'traditional' ? 'Tradicional' : 'Doce'}, Borda: ${pizza.border})\n`;
                });
                if (item.isCombo && item.comboBorderPrice > 0) {
                    message += `  (Custo adicional da borda: R$${item.comboBorderPrice.toFixed(2)})\n`;
                }
                message += `  Subtotal: R$${(item.price * item.quantity).toFixed(2)}\n`;
            });
            message += `\n*Total*: R$${total.toFixed(2)}\n`;
            message += `\nAguardamos sua confirmação! 😊`;
            
            window.open(`https://wa.me/${config.whatsapp}?text=${encodeURIComponent(message)}`, '_blank');
            showNotification(`Pedido de R$${total.toFixed(2)} enviado para ${name}!`);
            cartItems = [];
            updateCartDisplay();
            closeModal('checkout-modal');
            nameInput.value = '';
            addressInput.value = '';
            phoneInput.value = '';
        }

        // Função de notificação
        function showNotification(message, isError = false) {
            const notification = document.getElementById('notification');
            if (notification) {
                notification.textContent = message;
                notification.classList.add('visible');
                if (isError) {
                    notification.classList.add('error');
                } else {
                    notification.classList.remove('error');
                }
                setTimeout(() => {
                    notification.classList.remove('visible');
                }, 3000);
            } else {
                console.error('Elemento notification não encontrado');
            }
        }

        // Função de rolagem para seções
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            } else {
                console.error(`Seção com ID ${sectionId} não encontrada`);
            }
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM carregado, inicializando eventos');
            const addToCartButtons = document.querySelectorAll('.add-to-cart');
            console.log('Botões .add-to-cart encontrados:', addToCartButtons.length);
            if (addToCartButtons.length === 0) {
                console.warn('Nenhum botão .add-to-cart encontrado');
                showNotification('Erro: Nenhum item disponível para adicionar ao carrinho!', true);
            }
            addToCartButtons.forEach(button => {
                button.addEventListener('click', () => {
                    console.log('Botão clicado:', button.dataset.name);
                    addToCart(button);
                });
            });

            const cartToggleBtn = document.getElementById('cart-toggle-btn');
            if (cartToggleBtn) {
                cartToggleBtn.addEventListener('click', () => openModal('cart-modal'));
            } else {
                console.error('Elemento cart-toggle-btn não encontrado');
            }

            const stateSelect = document.getElementById('state-select');
            const citySelect = document.getElementById('city-select');
            if (stateSelect) {
                stateSelect.addEventListener('change', () => {
                    const stateNextBtn = document.getElementById('state-next-btn');
                    if (stateNextBtn) {
                        stateNextBtn.disabled = !stateSelect.value;
                    }
                });
            } else {
                console.error('Elemento state-select não encontrado na inicialização');
                showNotification('Erro: Interface de localização não encontrada', true);
            }
            if (citySelect) {
                citySelect.addEventListener('change', () => {
                    const cityNextBtn = document.getElementById('city-next-btn');
                    if (cityNextBtn) {
                        cityNextBtn.disabled = !citySelect.value;
                    }
                });
            } else {
                console.error('Elemento city-select não encontrado na inicialização');
                showNotification('Erro: Interface de localização não encontrada', true);
            }

            openModal('state-modal');
            loadStates();
        });
    </script>
</body>
</html>
