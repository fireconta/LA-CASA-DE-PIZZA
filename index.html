<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>La Casa de Pizzas - Cardápio</title>
  <script src="https://kit.fontawesome.com/1f7a5fcea1.js" crossorigin="anonymous"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Animações personalizadas */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    .fade-in {
      animation: fadeIn 0.5s ease-in-out;
    }
    .pulse {
      animation: pulse 2s infinite;
    }
    /* Efeito de hover nos cards */
    .card-hover:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }
    /* Estilo para imagens indisponíveis */
    img[alt="Imagem indisponível"] {
      background-color: #f1f5f9;
      color: #6b7280;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.875rem;
      font-weight: 500;
    }
    /* Banner promocional */
    .promo-banner {
      background: linear-gradient(90deg, #FF4500, #FFD700);
      animation: pulse 3s infinite;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-orange-100 via-amber-200 to-red-200 min-h-screen text-gray-800">
  <!-- Cabeçalho -->
  <header class="bg-gradient-to-r from-orange-600 via-orange-500 to-red-500 text-white shadow-xl sticky top-0 z-10">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
      <div class="flex items-center gap-4">
        <a href="admin.html" title="Acessar área administrativa">
          <img id="logo" src="https://via.placeholder.com/140x50.png?text=La+Casa+de+Pizzas" alt="Logo da La Casa de Pizzas" class="h-14 rounded-lg hover:scale-110 transition-transform cursor-pointer">
        </a>
        <h1 class="text-3xl font-extrabold tracking-tight drop-shadow-lg">La Casa de Pizzas</h1>
      </div>
      <div>
        <button id="dark-mode-toggle" class="bg-amber-400 text-gray-800 px-4 py-2 rounded-lg font-semibold hover:bg-amber-500 transition-all flex items-center gap-2">
          <i class="fas fa-moon"></i> Modo Escuro
        </button>
      </div>
    </div>
  </header>

  <!-- Banner Promocional -->
  <section class="promo-banner text-center py-4 text-white shadow-md">
    <p class="text-lg font-bold flex items-center justify-center gap-2">
      <i class="fas fa-star animate-spin"></i>
      Aproveite nossas promoções! Descontos em pizzas e combos hoje!
      <i class="fas fa-star animate-spin"></i>
    </p>
  </section>

  <!-- Seção Principal -->
  <main class="container mx-auto px-4 py-8">
    <!-- Filtros -->
    <section class="bg-white rounded-xl shadow-lg p-6 mb-8 border-t-4 border-orange-500">
      <h2 class="text-2xl font-bold text-orange-600 mb-4 flex items-center gap-2">
        <i class="fas fa-filter"></i> Filtrar Cardápio
      </h2>
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
        <input type="text" id="search-input" placeholder="Pesquisar por nome..." class="border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-orange-500 shadow-sm" aria-label="Pesquisar por nome">
        <select id="category-filter" class="border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-orange-500 shadow-sm" aria-label="Filtrar por categoria">
          <option value="">Todas as Categorias</option>
          <option value="Salgadas">Salgadas</option>
          <option value="Doces">Doces</option>
          <option value="Vegetarianas">Vegetarianas</option>
          <option value="Bebidas">Bebidas</option>
          <option value="Combos">Combos</option>
        </select>
        <button onclick="resetFilters()" class="bg-orange-500 text-white px-4 py-3 rounded-lg hover:bg-orange-600 transition-all flex items-center gap-2 shadow-sm">
          <i class="fas fa-sync-alt"></i> Limpar Filtros
        </button>
      </div>
    </section>

    <!-- Lista de Itens -->
    <section id="menu-items" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Itens serão inseridos dinamicamente via JavaScript -->
    </section>

    <!-- Paginação -->
    <div class="flex justify-center gap-4 mt-8">
      <button onclick="changePage(-1)" id="prev-page" class="bg-orange-500 text-white px-5 py-3 rounded-lg hover:bg-orange-600 transition-all flex items-center gap-2 disabled:bg-gray-300 disabled:cursor-not-allowed shadow-md">
        <i class="fas fa-chevron-left"></i> Anterior
      </button>
      <span id="page-info" class="self-center text-xl font-medium bg-white px-4 py-2 rounded-lg shadow-md">Página 1</span>
      <button onclick="changePage(1)" id="next-page" class="bg-orange-500 text-white px-5 py-3 rounded-lg hover:bg-orange-600 transition-all flex items-center gap-2 disabled:bg-gray-300 disabled:cursor-not-allowed shadow-md">
        Próxima <i class="fas fa-chevron-right"></i>
      </button>
    </div>
  </main>

  <!-- Modal de Detalhes do Item -->
  <div id="item-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center hidden z-20">
    <div class="bg-white rounded-2xl p-8 max-w-lg w-full max-h-[90vh] overflow-y-auto relative shadow-2xl border-t-4 border-orange-500">
      <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-600 hover:text-gray-800 transition-all">
        <i class="fas fa-times text-2xl"></i>
      </button>
      <img id="modal-image" src="" alt="Imagem do item" class="w-full h-56 object-cover rounded-lg mb-4 shadow-md">
      <h2 id="modal-name" class="text-3xl font-bold text-orange-600 mb-2"></h2>
      <p id="modal-description" class="text-gray-600 mb-4 leading-relaxed"></p>
      <p id="modal-price" class="text-xl font-semibold text-gray-800 mb-3 bg-amber-100 inline-block px-4 py-1 rounded-full"></p>
      <p class="text-sm text-gray-600 mb-2"><strong>Categoria:</strong> <span id="modal-category"></span></p>
      <p class="text-sm text-gray-600 mb-2"><strong>Ingredientes:</strong> <span id="modal-ingredients"></span></p>
      <p class="text-sm text-gray-600 mb-4"><strong>Avaliação:</strong> <span id="modal-rating"></span> (<span id="modal-num-ratings"></span> avaliações)</p>
      <!-- Tamanhos -->
      <div class="mb-4">
        <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2">
          <i class="fas fa-ruler"></i> Tamanhos
        </h3>
        <select id="modal-sizes" class="border border-gray-300 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-orange-500 shadow-sm" onchange="updateModalPrice()">
          <!-- Opções serão preenchidas via JavaScript -->
        </select>
      </div>
      <!-- Extras -->
      <div class="mb-4">
        <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2">
          <i class="fas fa-plus-circle"></i> Extras
        </h3>
        <div id="modal-extras" class="space-y-3">
          <!-- Checkboxes serão preenchidos via JavaScript -->
        </div>
      </div>
      <!-- Bordas -->
      <div class="mb-4">
        <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2">
          <i class="fas fa-border-all"></i> Bordas
        </h3>
        <select id="modal-borders" class="border border-gray-300 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-orange-500 shadow-sm" onchange="updateModalPrice()">
          <!-- Opções serão preenchidas via JavaScript -->
        </select>
      </div>
      <!-- Itens do Combo (se aplicável) -->
      <div id="modal-combo-items" class="mb-4 hidden">
        <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2">
          <i class="fas fa-box-open"></i> Itens do Combo
        </h3>
        <ul id="modal-combo-items-list" class="list-disc list-inside text-gray-600 space-y-1"></ul>
      </div>
      <!-- Botão de Pedido -->
      <button onclick="addToCart()" class="bg-orange-500 text-white px-6 py-3 rounded-lg hover:bg-orange-600 transition-all w-full flex items-center justify-center gap-2 shadow-md hover:shadow-lg">
        <i class="fas fa-cart-plus"></i> Adicionar ao Pedido
      </button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="config.js" id="config-script"></script>
  <script src="cardapio.js" id="cardapio-script"></script>
  <script>
    let cardapioData = [];
    let filteredItems = [];
    let currentPage = 1;
    const itemsPerPage = 9;
    let selectedItem = null;
    let selectedSize = null;
    let selectedBorder = null;
    let selectedExtras = [];

    // Função para carregar os dados do cardápio
    function loadCardapioData() {
      const storedData = localStorage.getItem("cardapioData");
      if (storedData) {
        try {
          cardapioData = JSON.parse(storedData);
        } catch (err) {
          console.error("Erro ao carregar dados do localStorage:", err);
          cardapioData = [...window.cardapio];
          saveCardapioData();
        }
      } else {
        cardapioData = [...window.cardapio];
        saveCardapioData();
      }
      filteredItems = [...cardapioData];
      renderMenuItems();
    }

    // Função para salvar os dados do cardápio no localStorage
    function saveCardapioData() {
      localStorage.setItem("cardapioData", JSON.stringify(cardapioData));
    }

    // Função para aplicar configurações do config.js
    function applyConfigStyles() {
      document.getElementById("logo").src = window.config.logoUrl;
      document.querySelector("h1").textContent = window.config.pizzariaName;
      document.documentElement.style.setProperty('--primary-color', window.config.primaryColor);
      document.documentElement.style.setProperty('--secondary-color', window.config.secondaryColor);
      document.documentElement.style.setProperty('--background-color', window.config.backgroundColor);
      document.documentElement.style.setProperty('--text-color', window.config.textColor);
    }

    // Função para renderizar os itens do cardápio
    function renderMenuItems() {
      const start = (currentPage - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const itemsToShow = filteredItems.slice(start, end);

      const menuItems = document.getElementById("menu-items");
      menuItems.innerHTML = "";
      itemsToShow.forEach(item => {
        const price = item.promocao?.ativo ? item.promocao.precoPromocional : item.preço;
        const card = document.createElement("div");
        card.className = "bg-white rounded-xl shadow-md overflow-hidden transition-all fade-in card-hover";
        card.innerHTML = `
          <img src="${item.imagem}" alt="${item.nome}" class="w-full h-48 object-cover hover:opacity-90 transition-opacity">
          <div class="p-5">
            <h3 class="text-xl font-bold text-orange-600 mb-2">${item.nome}</h3>
            <p class="text-gray-600 text-sm mb-3 line-clamp-2">${item.descrição}</p>
            <p class="text-gray-800 font-semibold text-lg mb-2 ${item.promocao?.ativo ? 'line-through text-gray-500' : ''}">R$ ${item.preço.toFixed(2)}</p>
            ${item.promocao?.ativo ? `<p class="text-green-600 font-semibold text-lg mb-2">Promoção: R$ ${item.promocao.precoPromocional.toFixed(2)}</p>` : ''}
            <p class="text-sm text-gray-600 mb-3 flex items-center gap-1">
              <i class="fas fa-star text-yellow-400"></i> ${item.avaliacao ? item.avaliacao.toFixed(1) : 'N/A'} (${item.numAvaliacoes} avaliações)
            </p>
            <button onclick="openModal(${item.id})" class="bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-all w-full flex items-center justify-center gap-2 shadow-sm hover:shadow-md">
              <i class="fas fa-eye"></i> Ver Detalhes
            </button>
          </div>
        `;
        menuItems.appendChild(card);
      });

      const totalPages = Math.ceil(filteredItems.length / itemsPerPage);
      document.getElementById("page-info").textContent = `Página ${currentPage} de ${totalPages}`;
      document.getElementById("prev-page").disabled = currentPage === 1;
      document.getElementById("next-page").disabled = currentPage === totalPages;
    }

    // Função para abrir o modal com detalhes do item
    function openModal(itemId) {
      selectedItem = cardapioData.find(item => item.id === itemId);
      if (!selectedItem) return;

      document.getElementById("modal-image").src = selectedItem.imagem;
      document.getElementById("modal-image").onerror = function() {
        this.src = 'https://via.placeholder.com/300x200.png?text=Imagem+Indisponível';
        this.alt = 'Imagem indisponível';
      };
      document.getElementById("modal-name").textContent = selectedItem.nome;
      document.getElementById("modal-description").textContent = selectedItem.descrição;
      document.getElementById("modal-category").textContent = selectedItem.categoria;
      document.getElementById("modal-ingredients").textContent = selectedItem.ingredientes.length ? selectedItem.ingredientes.join(", ") : "Nenhum ingrediente listado";
      document.getElementById("modal-rating").textContent = selectedItem.avaliacao ? selectedItem.avaliacao.toFixed(1) : 'N/A';
      document.getElementById("modal-num-ratings").textContent = selectedItem.numAvaliacoes;

      // Tamanhos
      const sizesSelect = document.getElementById("modal-sizes");
      sizesSelect.innerHTML = "";
      const sizes = Object.entries(selectedItem.tamanhos);
      if (sizes.length > 0) {
        sizes.forEach(([size, price], index) => {
          const option = document.createElement("option");
          option.value = size;
          option.textContent = `${size} - R$ ${price.toFixed(2)}`;
          sizesSelect.appendChild(option);
          if (index === 0) selectedSize = size;
        });
      } else {
        sizesSelect.innerHTML = '<option value="">Tamanho único</option>';
        selectedSize = null;
      }

      // Extras
      const extrasContainer = document.getElementById("modal-extras");
      extrasContainer.innerHTML = "";
      selectedExtras = [];
      const extras = Object.entries(selectedItem.extrasDisponiveis);
      if (extras.length > 0) {
        extras.forEach(([extra, price]) => {
          const div = document.createElement("div");
          div.className = "flex items-center gap-2";
          div.innerHTML = `
            <input type="checkbox" id="extra-${extra}" value="${extra}" onchange="updateSelectedExtras(this)" class="h-4 w-4 text-orange-500 focus:ring-orange-500 border-gray-300 rounded">
            <label for="extra-${extra}" class="text-gray-600">${extra} (+ R$ ${price.toFixed(2)})</label>
          `;
          extrasContainer.appendChild(div);
        });
      } else {
        extrasContainer.innerHTML = '<p class="text-gray-600">Nenhum extra disponível</p>';
      }

      // Bordas
      const bordersSelect = document.getElementById("modal-borders");
      bordersSelect.innerHTML = "";
      const borders = Object.entries(selectedItem.bordasDisponiveis);
      if (borders.length > 0) {
        borders.forEach(([border, price], index) => {
          const option = document.createElement("option");
          option.value = border;
          option.textContent = `${border} - R$ ${price.toFixed(2)}`;
          bordersSelect.appendChild(option);
          if (index === 0) selectedBorder = border;
        });
      } else {
        bordersSelect.innerHTML = '<option value="">Sem borda disponível</option>';
        selectedBorder = null;
      }

      // Itens do Combo
      const comboItemsDiv = document.getElementById("modal-combo-items");
      const comboItemsList = document.getElementById("modal-combo-items-list");
      comboItemsList.innerHTML = "";
      if (selectedItem.categoria === "Combos" && selectedItem.itens) {
        comboItemsDiv.classList.remove("hidden");
        selectedItem.itens.forEach(itemId => {
          const comboItem = cardapioData.find(item => item.id === itemId);
          if (comboItem) {
            const li = document.createElement("li");
            li.textContent = comboItem.nome;
            comboItemsList.appendChild(li);
          }
        });
      } else {
        comboItemsDiv.classList.add("hidden");
      }

      updateModalPrice();
      document.getElementById("item-modal").classList.remove("hidden");
    }

    // Função para atualizar os extras selecionados
    function updateSelectedExtras(checkbox) {
      if (checkbox.checked) {
        selectedExtras.push(checkbox.value);
      } else {
        selectedExtras = selectedExtras.filter(extra => extra !== checkbox.value);
      }
      updateModalPrice();
    }

    // Função para atualizar o preço no modal
    function updateModalPrice() {
      let basePrice = selectedItem.promocao?.ativo ? selectedItem.promocao.precoPromocional : selectedItem.preço;
      if (selectedSize && selectedItem.tamanhos[selectedSize]) {
        basePrice = selectedItem.tamanhos[selectedSize];
      }
      let extraPrice = 0;
      selectedExtras.forEach(extra => {
        extraPrice += selectedItem.extrasDisponiveis[extra] || 0;
      });
      let borderPrice = 0;
      if (selectedBorder && selectedItem.bordasDisponiveis[selectedBorder]) {
        borderPrice = selectedItem.bordasDisponiveis[selectedBorder];
      }
      const totalPrice = basePrice + extraPrice + borderPrice;
      document.getElementById("modal-price").textContent = `R$ ${totalPrice.toFixed(2)}`;
    }

    // Função para fechar o modal
    function closeModal() {
      document.getElementById("item-modal").classList.add("hidden");
      selectedItem = null;
      selectedSize = null;
      selectedBorder = null;
      selectedExtras = [];
    }

    // Função para adicionar ao carrinho (placeholder)
    function addToCart() {
      alert(`Item "${selectedItem.nome}" adicionado ao carrinho!\nTamanho: ${selectedSize || 'Único'}\nBorda: ${selectedBorder || 'Nenhuma'}\nExtras: ${selectedExtras.length ? selectedExtras.join(", ") : 'Nenhum'}\nTotal: ${document.getElementById("modal-price").textContent}`);
      closeModal();
    }

    // Função para filtrar itens
    function filterItems() {
      const searchTerm = document.getElementById("search-input").value.toLowerCase();
      const categoryFilter = document.getElementById("category-filter").value;

      filteredItems = cardapioData.filter(item => {
        const matchesSearch = item.nome.toLowerCase().includes(searchTerm);
        const matchesCategory = categoryFilter ? item.categoria === categoryFilter : true;
        return matchesSearch && matchesCategory;
      });

      currentPage = 1;
      renderMenuItems();
    }

    // Função para resetar os filtros
    function resetFilters() {
      document.getElementById("search-input").value = "";
      document.getElementById("category-filter").value = "";
      filteredItems = [...cardapioData];
      currentPage = 1;
      renderMenuItems();
    }

    // Função para mudar de página
    function changePage(direction) {
      currentPage += direction;
      renderMenuItems();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Função para alternar modo escuro
    function toggleDarkMode() {
      document.body.classList.toggle("dark");
      const isDark = document.body.classList.contains("dark");
      document.getElementById("dark-mode-toggle").innerHTML = isDark
        ? '<i class="fas fa-sun"></i> Modo Claro'
        : '<i class="fas fa-moon"></i> Modo Escuro';
      document.body.classList.toggle("bg-gray-900", isDark);
      document.body.classList.toggle("text-white", isDark);
      document.body.classList.toggle("bg-gradient-to-br", !isDark);
      document.body.classList.toggle("from-orange-100", !isDark);
      document.body.classList.toggle("via-amber-200", !isDark);
      document.body.classList.toggle("to-red-200", !isDark);
    }

    // Inicialização
    const configScript = document.getElementById("config-script");
    const cardapioScript = document.getElementById("cardapio-script");

    configScript.onload = function() {
      console.log("Config.js carregado.");
      if (window.config) {
        applyConfigStyles();
        cardapioScript.onload = function() {
          console.log("Cardapio.js carregado.");
          if (window.cardapio) {
            loadCardapioData();
            document.getElementById("search-input").addEventListener("input", filterItems);
            document.getElementById("category-filter").addEventListener("change", filterItems);
            document.getElementById("dark-mode-toggle").addEventListener("click", toggleDarkMode);
          } else {
            console.error("Erro: window.cardapio não foi definido.");
            alert("Erro ao carregar o cardápio. Verifique o arquivo cardapio.js.");
          }
        };
        cardapioScript.onerror = function() {
          console.error("Erro ao carregar cardapio.js.");
          alert("Erro ao carregar o cardápio. Verifique o arquivo cardapio.js.");
        };
      }
    };

    configScript.onerror = function() {
      console.error("Erro ao carregar config.js.");
      alert("Erro ao carregar as configurações. Verifique o arquivo config.js.");
    };
  </script>
</body>
</html>