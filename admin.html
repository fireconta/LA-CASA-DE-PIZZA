<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>La Casa de Pizzas - Administração</title>
  <script src="https://kit.fontawesome.com/1f7a5fcea1.js" crossorigin="anonymous"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
</head>
<body class="bg-beige-100 dark:bg-gray-800 font-roboto">
  <!-- Loader -->
  <div id="loader" class="fixed inset-0 bg-opacity-80 flex items-center justify-center z-50">
    <div class="loader"></div>
  </div>

  <!-- Banner de Erro -->
  <div id="error-banner" class="fixed top-0 left-0 right-0 bg-red-600 text-white text-center py-4 z-50 hidden">
    <p id="error-message"></p>
    <button onclick="hideErrorBanner()" class="absolute top-2 right-4 text-white hover:text-gray-200" aria-label="Fechar notificação de erro">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <!-- Login Modal -->
  <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-20">
    <div class="rounded-2xl p-8 max-w-sm w-full shadow-2xl border-t-4 border-green-600 pizza-section">
      <h2 class="font-playfair text-2xl font-bold mb-4 flex items-center gap-2">
        <i class="fas fa-lock"></i> Acesso Administrativo
      </h2>
      <input type="password" id="admin-password" placeholder="Digite a senha..." class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300 mb-4" aria-label="Digite a senha de administrador">
      <button onclick="login()" class="text-white rounded-full hover:bg-opacity-80 transition-all duration-300 w-full flex items-center justify-center gap-2 shadow-md pizza-button glow" aria-label="Fazer login">
        <i class="fas fa-sign-in-alt"></i> Entrar
      </button>
    </div>
  </div>

  <!-- Cabeçalho -->
  <header class="text-white shadow-xl sticky top-0 z-10 hidden" id="header">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
      <div class="flex items-center gap-4">
        <a href="index.html">
          <img id="logo" src="" alt="Logo da La Casa de Pizzas" class="rounded-full hover:scale-110 transition-transform duration-300 cursor-pointer" loading="lazy">
        </a>
        <h1 class="font-playfair text-3xl font-bold tracking-tight drop-shadow-lg"></h1>
      </div>
      <div class="flex items-center gap-4">
        <button onclick="logout()" class="bg-red-600 text-white rounded-full hover:bg-red-700 transition-all duration-300 flex items-center gap-2 shadow-md pizza-button glow" aria-label="Sair">
          <i class="fas fa-sign-out-alt"></i> Sair
        </button>
      </div>
    </div>
  </header>

  <!-- Seção Principal -->
  <main class="container mx-auto px-4 py-8 hidden" id="main-content">
    <!-- Gerenciar Itens -->
    <section class="rounded-2xl shadow-xl p-6 mb-8 border-t-4 border-green-600 pizza-section">
      <h2 class="font-playfair text-2xl font-bold mb-4 flex items-center gap-3">
        <i class="fas fa-pizza-slice"></i> Gerenciar Itens do Cardápio
      </h2>
      <button onclick="openAddItemModal()" class="text-white rounded-full hover:bg-opacity-80 transition-all duration-300 flex items-center gap-2 mb-4 shadow-md pizza-button glow" aria-label="Adicionar novo item">
        <i class="fas fa-plus"></i> Adicionar Novo Item
      </button>
      <div id="item-list" class="space-y-4">
        <!-- Itens serão inseridos dinamicamente -->
      </div>
    </section>

    <!-- Gerenciar Bordas -->
    <section class="rounded-2xl shadow-xl p-6 mb-8 border-t-4 border-green-600 pizza-section">
      <h2 class="font-playfair text-2xl font-bold mb-4 flex items-center gap-3">
        <i class="fas fa-border-all"></i> Gerenciar Bordas Disponíveis
      </h2>
      <div class="flex gap-4 mb-4">
        <input type="text" id="new-border-name" placeholder="Nome da borda..." class="border border-gray-200 rounded-lg p-3 flex-1 focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" aria-label="Nome da nova borda">
        <input type="number" id="new-border-price" placeholder="Preço (R$)" step="0.01" class="border border-gray-200 rounded-lg p-3 w-32 focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" aria-label="Preço da nova borda">
        <button onclick="addBorder()" class="text-white rounded-full hover:bg-opacity-80 transition-all duration-300 flex items-center gap-2 shadow-md pizza-button glow" aria-label="Adicionar borda">
          <i class="fas fa-plus"></i> Adicionar
        </button>
      </div>
      <div id="border-list" class="space-y-4">
        <!-- Bordas serão inseridas dinamicamente -->
      </div>
    </section>
  </main>

  <!-- Modal para Adicionar/Editar Item -->
  <div id="edit-item-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center hidden z-20 transition-opacity duration-300">
    <div class="rounded-2xl p-8 w-full max-h-[90vh] overflow-y-auto relative shadow-2xl border-t-4 border-green-600 pizza-section transform transition-all duration-300 scale-95">
      <button onclick="closeEditItemModal()" class="absolute top-4 right-4 text-gray-600 hover:text-gray-800 transition-all duration-300" aria-label="Fechar modal de edição">
        <i class="fas fa-times text-2xl"></i>
      </button>
      <h2 id="edit-modal-title" class="font-playfair text-2xl font-bold mb-4"></h2>
      <form id="edit-item-form" class="space-y-4">
        <div>
          <label for="edit-nome" class="block mb-1">Nome</label>
          <input type="text" id="edit-nome" name="nome" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" required aria-label="Nome do item">
        </div>
        <div>
          <label for="edit-categoria" class="block mb-1">Categoria</label>
          <select id="edit-categoria" name="categoria" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" required aria-label="Categoria do item">
            <option value="Salgadas">Salgadas</option>
            <option value="Doces">Doces</option>
            <option value="Vegetarianas">Vegetarianas</option>
            <option value="Bebidas">Bebidas</option>
            <option value="Combos">Combos</option>
          </select>
        </div>
        <div>
          <label for="edit-preco" class="block mb-1">Preço (R$)</label>
          <input type="number" id="edit-preco" name="preço" step="0.01" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" required aria-label="Preço do item">
        </div>
        <div>
          <label for="edit-imagem" class="block mb-1">URL da Imagem</label>
          <input type="url" id="edit-imagem" name="imagem" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" aria-label="URL da imagem do item">
        </div>
        <div>
          <label for="edit-descricao" class="block mb-1">Descrição</label>
          <textarea id="edit-descricao" name="descrição" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" rows="3" aria-label="Descrição do item"></textarea>
        </div>
        <div>
          <label for="edit-ingredientes" class="block mb-1">Ingredientes (separados por vírgula)</label>
          <input type="text" id="edit-ingredientes" name="ingredientes" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" aria-label="Ingredientes do item">
        </div>
        <div>
          <label for="edit-tamanhos" class="block mb-1">Tamanhos e Preços (formato: Pequena:35.00,Média:45.00)</label>
          <input type="text" id="edit-tamanhos" name="tamanhos" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" aria-label="Tamanhos e preços do item">
        </div>
        <div>
          <label for="edit-extras" class="block mb-1">Extras e Preços (formato: Azeitonas:5.00,Rúcula:6.00)</label>
          <input type="text" id="edit-extras" name="extrasDisponiveis" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" aria-label="Extras disponíveis e preços">
        </div>
        <div>
          <label for="edit-bordas" class="block mb-1">Bordas Disponíveis (selecionar)</label>
          <div id="edit-bordas" class="space-y-2 max-h-40 overflow-y-auto">
            <!-- Checkboxes de bordas serão preenchidos dinamicamente -->
          </div>
        </div>
        <div>
          <label for="edit-promocao" class="block mb-1">Promoção (ativo:preço, ex.: true:40.00)</label>
          <input type="text" id="edit-promocao" name="promocao" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" aria-label="Detalhes da promoção">
        </div>
        <div>
          <label for="edit-avaliacao" class="block mb-1">Avaliação (0 a 5)</label>
          <input type="number" id="edit-avaliacao" name="avaliacao" step="0.1" min="0" max="5" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" aria-label="Avaliação do item">
        </div>
        <div>
          <label for="edit-numAvaliacoes" class="block mb-1">Número de Avaliações</label>
          <input type="number" id="edit-numAvaliacoes" name="numAvaliacoes" min="0" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" aria-label="Número de avaliações do item">
        </div>
        <div id="edit-combo-items-section" class="hidden">
          <label for="edit-combo-items" class="block mb-1">Itens do Combo (IDs separados por vírgula)</label>
          <input type="text" id="edit-combo-items" name="itens" class="border border-gray-200 rounded-lg p-3 w-full focus:outline-none focus:ring-2 focus:ring-green-600 shadow-sm transition-all duration-300" aria-label="Itens do combo">
        </div>
        <button type="submit" class="text-white rounded-full hover:bg-opacity-80 transition-all duration-300 w-full flex items-center justify-center gap-2 shadow-md pizza-button glow" aria-label="Salvar item">
          <i class="fas fa-save"></i> Salvar
        </button>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script src="config.js" id="config-script"></script>
  <script src="cardapio.js" id="cardapio-script"></script>
  <script>
    let cardapioData = [];
    let globalBorders = JSON.parse(localStorage.getItem("globalBorders")) || {
      "Tradicional": 0.00,
      "Catupiry": 8.00,
      "Cheddar Cremoso": 8.00,
      "Gorgonzola": 10.00,
      "Cream Cheese": 10.00,
      "Parmesão": 9.00,
      "Chocolate": 8.00,
      "Doce de Leite": 8.00
    };
    let editingItemId = null;

    function showErrorBanner(message) {
      const errorBanner = document.getElementById("error-banner");
      const errorMessage = document.getElementById("error-message");
      errorMessage.textContent = message;
      errorBanner.classList.remove("hidden");
    }

    function hideErrorBanner() {
      const errorBanner = document.getElementById("error-banner");
      errorBanner.classList.add("hidden");
    }

    function applyConfigStyles() {
      if (!window.config) {
        console.error("Configuração não disponível.");
        showErrorBanner("Erro: Configurações não carregadas. O arquivo `config.js` pode estar ausente ou mal configurado no diretório raiz.");
        return;
      }
      document.querySelector("h1").style.fontSize = window.config.fonts.sizes.header;
      document.querySelectorAll("h2").forEach(h2 => h2.style.fontSize = window.config.fonts.sizes.title);
      document.body.style.fontSize = window.config.fonts.sizes.body;

      document.getElementById("logo").style.height = window.config.sizes.logoHeight;
      document.querySelectorAll("button").forEach(btn => {
        btn.style.padding = window.config.sizes.buttonPadding;
      });
      document.querySelector("#edit-item-modal > div").style.maxWidth = window.config.sizes.modalMaxWidth;

      document.getElementById("logo").src = window.config.logoUrl;
      document.querySelector("h1").textContent = `Admin - ${window.config.pizzariaName}`;
    }

    function loadCardapioData() {
      if (!window.cardapio) {
        console.error("Cardápio não disponível.");
        showErrorBanner("Erro: Dados do cardápio não carregados. O arquivo `cardapio.js` pode estar ausente ou mal configurado no diretório raiz.");
        return;
      }
      const storedData = localStorage.getItem("cardapioData");
      if (storedData) {
        try {
          cardapioData = JSON.parse(storedData);
        } catch (err) {
          console.error("Erro ao carregar dados do localStorage:", err);
          if (Array.isArray(window.cardapio)) {
            cardapioData = [...window.cardapio];
            saveCardapioData();
          } else {
            console.error("window.cardapio não é um array válido.");
            showErrorBanner("Erro: Dados do cardápio em `cardapio.js` são inválidos. Verifique a estrutura do arquivo no diretório raiz.");
            return;
          }
        }
      } else {
        if (Array.isArray(window.cardapio)) {
          cardapioData = [...window.cardapio];
          saveCardapioData();
        } else {
          console.error("window.cardapio não é um array válido.");
          showErrorBanner("Erro: Dados do cardápio em `cardapio.js` são inválidos. Verifique a estrutura do arquivo no diretório raiz.");
          return;
        }
      }
      renderItemList();
      renderBorderList();
      document.getElementById("loader").classList.add("hidden");
    }

    function saveCardapioData() {
      localStorage.setItem("cardapioData", JSON.stringify(cardapioData));
    }

    function saveGlobalBorders() {
      localStorage.setItem("globalBorders", JSON.stringify(globalBorders));
    }

    function login() {
      const passwordInput = document.getElementById("admin-password").value;
      const hashedInput = hashPassword(passwordInput);
      if (hashedInput === window.config.adminPassword) {
        document.getElementById("login-modal").classList.add("hidden");
        document.getElementById("header").classList.remove("hidden");
        document.getElementById("main-content").classList.remove("hidden");
      } else {
        alert("Senha incorreta! A senha padrão é 'LVz'.");
      }
    }

    function logout() {
      window.location.reload();
    }

    function hashPassword(password) {
      return password === "LVz" ? window.config.adminPassword : "";
    }

    function renderItemList() {
      const itemList = document.getElementById("item-list");
      itemList.innerHTML = "";
      cardapioData.forEach(item => {
        const div = document.createElement("div");
        div.className = "flex justify-between items-center p-4 rounded-lg pizza-card";
        div.innerHTML = `
          <div>
            <h3 class="font-playfair text-lg font-semibold text-dark-mode">${item.nome}</h3>
            <p class="text-dark-mode">Categoria: ${item.categoria} | Preço: R$ ${item.preço.toFixed(2)}</p>
          </div>
          <div class="flex gap-2">
            <button onclick="openEditItemModal(${item.id})" class="text-white rounded-full hover:bg-opacity-80 transition-all duration-300 pizza-button glow" style="padding: 0.5rem 1rem;" aria-label="Editar ${item.nome}">
              <i class="fas fa-edit"></i>
            </button>
            <button onclick="deleteItem(${item.id})" class="bg-red-600 text-white rounded-full hover:bg-red-700 transition-all duration-300 pizza-button glow" style="padding: 0.5rem 1rem;" aria-label="Excluir ${item.nome}">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        `;
        itemList.appendChild(div);
      });
    }

    function renderBorderList() {
      const borderList = document.getElementById("border-list");
      borderList.innerHTML = "";
      Object.entries(globalBorders).forEach(([border, price]) => {
        const div = document.createElement("div");
        div.className = "flex justify-between items-center p-4 rounded-lg pizza-card";
        div.innerHTML = `
          <div>
            <h3 class="font-playfair text-lg font-semibold text-dark-mode">${border}</h3>
            <p class="text-dark-mode">Preço: R$ ${price.toFixed(2)}</p>
          </div>
          <button onclick="deleteBorder('${border}')" class="bg-red-600 text-white rounded-full hover:bg-red-700 transition-all duration-300 pizza-button glow" style="padding: 0.5rem 1rem;" aria-label="Excluir borda ${border}">
            <i class="fas fa-trash"></i>
          </button>
        `;
        borderList.appendChild(div);
      });
    }

    function addBorder() {
      const borderName = document.getElementById("new-border-name").value.trim();
      const borderPrice = parseFloat(document.getElementById("new-border-price").value);
      if (borderName && !isNaN(borderPrice) && borderPrice >= 0) {
        globalBorders[borderName] = borderPrice;
        saveGlobalBorders();
        renderBorderList();
        document.getElementById("new-border-name").value = "";
        document.getElementById("new-border-price").value = "";
      } else {
        alert("Por favor, insira um nome e preço válidos para a borda.");
      }
    }

    function deleteBorder(borderName) {
      if (confirm(`Tem certeza que deseja excluir a borda "${borderName}"? Isso pode afetar itens existentes.`)) {
        delete globalBorders[borderName];
        saveGlobalBorders();
        cardapioData.forEach(item => {
          if (item.bordasDisponiveis && borderName in item.bordasDisponiveis) {
            delete item.bordasDisponiveis[borderName];
          }
        });
        saveCardapioData();
        renderBorderList();
        renderItemList();
      }
    }

    function openAddItemModal() {
      editingItemId = null;
      document.getElementById("edit-modal-title").textContent = "Adicionar Novo Item";
      document.getElementById("edit-item-form").reset();
      document.getElementById("edit-combo-items-section").classList.add("hidden");
      populateBordersCheckboxes({});
      const modal = document.getElementById("edit-item-modal");
      modal.classList.remove("hidden");
      setTimeout(() => {
        modal.querySelector("div").classList.remove("scale-95");
      }, 10);
    }

    function openEditItemModal(itemId) {
      const item = cardapioData.find(i => i.id === itemId);
      if (!item) return;
      editingItemId = itemId;
      document.getElementById("edit-modal-title").textContent = "Editar Item";
      document.getElementById("edit-nome").value = item.nome;
      document.getElementById("edit-categoria").value = item.categoria;
      document.getElementById("edit-preco").value = item.preço;
      document.getElementById("edit-imagem").value = item.imagem;
      document.getElementById("edit-descricao").value = item.descrição;
      document.getElementById("edit-ingredientes").value = item.ingredientes.join(", ");
      document.getElementById("edit-tamanhos").value = Object.entries(item.tamanhos).map(([size, price]) => `${size}:${price}`).join(",");
      document.getElementById("edit-extras").value = Object.entries(item.extrasDisponiveis).map(([extra, price]) => `${extra}:${price}`).join(",");
      populateBordersCheckboxes(item.bordasDisponiveis);
      document.getElementById("edit-promocao").value = item.promocao ? `${item.promocao.ativo}:${item.promocao.precoPromocional}` : "";
      document.getElementById("edit-avaliacao").value = item.avaliacao || "";
      document.getElementById("edit-numAvaliacoes").value = item.numAvaliacoes || "";
      const comboSection = document.getElementById("edit-combo-items-section");
      if (item.categoria === "Combos") {
        comboSection.classList.remove("hidden");
        document.getElementById("edit-combo-items").value = item.itens ? item.itens.join(",") : "";
      } else {
        comboSection.classList.add("hidden");
      }
      const modal = document.getElementById("edit-item-modal");
      modal.classList.remove("hidden");
      setTimeout(() => {
        modal.querySelector("div").classList.remove("scale-95");
      }, 10);
    }

    function populateBordersCheckboxes(selectedBorders) {
      const bordersContainer = document.getElementById("edit-bordas");
      bordersContainer.innerHTML = "";
      Object.keys(globalBorders).forEach(border => {
        const div = document.createElement("div");
        div.className = "flex items-center gap-2";
        div.innerHTML = `
          <input type="checkbox" id="border-${border}" name="bordas" value="${border}" ${selectedBorders[border] !== undefined ? 'checked' : ''} class="h-4 w-4 focus:ring-2 focus:ring-green-600 rounded">
          <label for="border-${border}" class="text-dark-mode">${border} (R$ ${globalBorders[border].toFixed(2)})</label>
        `;
        bordersContainer.appendChild(div);
      });
    }

    function closeEditItemModal() {
      const modal = document.getElementById("edit-item-modal");
      modal.querySelector("div").classList.add("scale-95");
      setTimeout(() => {
        modal.classList.add("hidden");
      }, 300);
    }

    document.getElementById("edit-item-form").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      const newItem = {
        id: editingItemId || (cardapioData.length ? Math.max(...cardapioData.map(i => i.id)) + 1 : 1),
        nome: formData.get("nome"),
        categoria: formData.get("categoria"),
        preço: parseFloat(formData.get("preço")),
        imagem: formData.get("imagem") || "https://via.placeholder.com/300x200.png?text=Imagem+Indisponível",
        descrição: formData.get("descrição"),
        ingredientes: formData.get("ingredientes").split(",").map(i => i.trim()).filter(i => i),
        tamanhos: {},
        extrasDisponiveis: {},
        bordasDisponiveis: {},
        promocao: null,
        avaliacao: parseFloat(formData.get("avaliacao")) || null,
        numAvaliacoes: parseInt(formData.get("numAvaliacoes")) || 0
      };

      const tamanhosInput = formData.get("tamanhos");
      if (tamanhosInput) {
        tamanhosInput.split(",").forEach(pair => {
          const [size, price] = pair.split(":");
          if (size && price) {
            newItem.tamanhos[size.trim()] = parseFloat(price);
          }
        });
      }

      const extrasInput = formData.get("extrasDisponiveis");
      if (extrasInput) {
        extrasInput.split(",").forEach(pair => {
          const [extra, price] = pair.split(":");
          if (extra && price) {
            newItem.extrasDisponiveis[extra.trim()] = parseFloat(price);
          }
        });
      }

      const selectedBorders = Array.from(document.querySelectorAll('input[name="bordas"]:checked')).map(input => input.value);
      selectedBorders.forEach(border => {
        newItem.bordasDisponiveis[border] = globalBorders[border];
      });

      const promocaoInput = formData.get("promocao");
      if (promocaoInput) {
        const [ativo, precoPromocional] = promocaoInput.split(":");
        if (ativo && precoPromocional) {
          newItem.promocao = {
            ativo: ativo.toLowerCase() === "true",
            precoPromocional: parseFloat(precoPromocional)
          };
        }
      }

      if (newItem.categoria === "Combos") {
        const comboItemsInput = formData.get("itens");
        newItem.itens = comboItemsInput ? comboItemsInput.split(",").map(id => parseInt(id.trim())).filter(id => !isNaN(id)) : [];
      }

      if (editingItemId) {
        const index = cardapioData.findIndex(i => i.id === editingItemId);
        cardapioData[index] = newItem;
      } else {
        cardapioData.push(newItem);
      }

      saveCardapioData();
      renderItemList();
      closeEditItemModal();
    });

    function deleteItem(itemId) {
      if (confirm("Tem certeza que deseja excluir este item?")) {
        cardapioData = cardapioData.filter(i => i.id !== itemId);
        saveCardapioData();
        renderItemList();
      }
    }

    document.getElementById("edit-categoria").addEventListener("change", function() {
      const comboSection = document.getElementById("edit-combo-items-section");
      if (this.value === "Combos") {
        comboSection.classList.remove("hidden");
      } else {
        comboSection.classList.add("hidden");
      }
    });

    const configScript = document.getElementById("config-script");
    const cardapioScript = document.getElementById("cardapio-script");

    configScript.onerror = function() {
      console.error("Erro ao carregar config.js.");
      showErrorBanner("Erro: Não foi possível carregar o arquivo `config.js` no diretório raiz. Verifique se o arquivo existe e está no mesmo diretório que `admin.html`.");
      document.getElementById("loader").classList.add("hidden");
    };

    cardapioScript.onerror = function() {
      console.error("Erro ao carregar cardapio.js.");
      showErrorBanner("Erro: Não foi possível carregar o arquivo `cardapio.js` no diretório raiz. Verifique se o arquivo existe e está no mesmo diretório que `admin.html`.");
      document.getElementById("loader").classList.add("hidden");
    };

    configScript.onload = function() {
      console.log("Config.js carregado.");
      if (window.config) {
        const styleSheet = document.createElement("style");
        styleSheet.textContent = `
          .font-playfair {
            font-family: 'Playfair Display', serif;
          }
          .font-roboto {
            font-family: 'Roboto', sans-serif;
          }
          .bg-beige-100 {
            background-color: #F5DEB3;
            background-image: url('https://www.transparenttextures.com/patterns/wood-pattern.png');
          }
          .fade-in {
            animation: fadeIn ${window.config.animations.fadeInDuration} ease-in-out;
          }
          .glow {
            animation: glow ${window.config.animations.glowDuration} infinite;
          }
          @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
          }
          @keyframes glow {
            0% { box-shadow: 0 0 5px #FFD70080; }
            50% { box-shadow: 0 0 20px #FFD700CC; }
            100% { box-shadow: 0 0 5px #FFD70080; }
          }
          .pizza-card {
            background-color: #FFF8E1;
            border: 4px solid #FFD700;
            border-radius: 20px;
            position: relative;
          }
          .pizza-card:before {
            content: '';
            position: absolute;
            top: -8px;
            left: -8px;
            right: -8px;
            bottom: -8px;
            border: 4px dashed #FF6347;
            border-radius: 24px;
            pointer-events: none;
          }
          .pizza-section {
            background-color: #FFF8E1;
            border-color: #228B22;
          }
          .pizza-button {
            background-color: #FF6347;
            color: white;
            border-color: #FF6347;
          }
          .pizza-button:hover {
            box-shadow: 0 0 15px #FFD70080;
          }
          .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #FF6347;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            margin: 20px auto;
            animation: spin 1s linear infinite;
          }
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
          .dark .pizza-card, .dark .pizza-section {
            background-color: #4B3F2F !important;
          }
          .dark .text-dark-mode {
            color: #F5DEB3 !important;
          }
          .dark .bg-dark-mode {
            background-color: #3A2E1F !important;
          }
          .dark {
            background: #3A2E1F !important;
            color: #F5DEB3 !important;
          }
          .dark select, .dark input, .dark textarea {
            background-color: #4B3F2F;
            color: #F5DEB3;
          }
          header {
            background: linear-gradient(to right, #FF6347, #FFD700);
          }
        `;
        document.head.appendChild(styleSheet);

        applyConfigStyles();
        cardapioScript.onload = function() {
          console.log("Cardapio.js carregado.");
          if (window.cardapio) {
            loadCardapioData();
          } else {
            console.error("Erro: window.cardapio não foi definido.");
            showErrorBanner("Erro: Variável `window.cardapio` não foi definida no arquivo `cardapio.js` no diretório raiz. Verifique o arquivo.");
            document.getElementById("loader").classList.add("hidden");
          }
        };
      } else {
        console.error("Erro: window.config não foi definido.");
        showErrorBanner("Erro: Variável `window.config` não foi definida no arquivo `config.js` no diretório raiz. Verifique o arquivo.");
        document.getElementById("loader").classList.add("hidden");
      }
    };
  </script>
</body>
</html>
